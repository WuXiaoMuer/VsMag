# VsMag - Magnetism IDE

# ![view](/img/view.png)

>  **VsMag** 是一款基于易语言开发的轻量级集成开发环境（IDE），具备代码编辑、自动提示、文件浏览、工具栏控制等功能，旨在提供简洁高效的编程体验。 

## 📁 项目概述

`VsMag` 是一个使用易语言编写的可视化 IDE 原型，具有如下特性：

- 支持多组件嵌入式布局（Explorer、Tool、DownTool、Message）
- 

代码编辑器支持语法高亮与自动完成

- 自定义界面绘制与刻度显示
- 可扩展的插件式架构设计（通过子程序模块化）

## 🧩 技术栈

|                         |                                            |
| ----------------------- | ------------------------------------------ |
| 易语言`.版本 2`         | 使用易语言 5.95 编写                       |
| `.支持库 CodeStyleEdit` | 提供代码编辑、语法高亮、自动提示等核心功能 |
| 窗口嵌套与父窗口控制    | 使用`窗口_置父`实现多窗体集成              |
| 文件操作                | 支持读写本地文件系统                       |

## 🖼️ 界面布局

整个主窗口由多个子窗口/控件组成，布局如下：

|            |                                    |                    |
| ---------- | ---------------------------------- | ------------------ |
| `Explorer` | 文件资源管理器                     | 右侧垂直面板       |
| `Tool`     | 顶部工具栏                         | 窗口顶部           |
| `DownTool` | 底部状态栏/输出栏                  | 窗口底部           |
| `Message`  | 消息提示面板（默认隐藏）           | 主窗口右侧（覆盖） |
| `code`     | 核心代码编辑器                     | 中央可编辑区域     |
| `画版`     | 自定义绘图区域（用于绘制刻度线等） | 与 code 并列       |

## 🔧 核心子程序说明

### ✅ `__启动窗口_创建完毕`

**功能：** 初始化窗口组件并完成布局嵌套。

\1. 读取配置文件 "Area" 内容作为自动完成词库

\2. 载入 Explorer、Tool、DownTool、Message 四个子窗口

\3. 将所有子窗口设置为主窗口的子窗口（使用窗口_置父）

\4. 调整各控件位置与尺寸

\5. 初始化 Explorer 并调用界面代理进行样式设置

**关键代码逻辑：**

自动完成填充 ＝ 到文本 (读入文件 (取运行目录 () ＋ “\Area”))

...

载入 (Explorer, , 假)

窗口_置父 (Explorer.取窗口句柄 (), _启动窗口.取窗口句柄 ())

Explorer.移动 (取用户区宽度 () － Explorer.宽度, 0, , )

### 🔄 `__启动窗口_尺寸被改变`

**功能：** 响应主窗口大小变化，动态调整所有子控件位置与尺寸。

**触发时机：** 用户拖动窗口改变大小时。

**调整内容：**

- `Explorer`：右对齐，高度自适应（避开 DownTool）
- `Tool`：固定顶部
- `DownTool`：固定底部，宽度占满
- `Message`：隐藏
- `code` 与 `画版`：重新定位以填充中央区域
- 调用 `界面代理.画横向刻度()` 更新标尺

### 🖋️ `_code_更新界面`

**功能：** 动态更新代码编辑器的旁注栏宽度（如行号或缩进指示器）。

.子程序 _code_更新界面

.局部变量 字符宽度, 整数型

字符宽度 ＝ code.取文本宽度 (#代码编辑框常量.风格_默认, “e”) × 取文本长度 (到文本 (code.取当前位置 ())) ＋ 单字符宽度

code.置旁注栏宽度 (0, 字符宽度)

> ✅ 实现了根据光标位置动态拉伸旁注宽度的效果。 

### 📂 `VsMag从文件加载数据`

**功能：** 从指定路径加载文件内容到编辑器。

|        |        |                  |
| ------ | ------ | ---------------- |
| `文件` | 文本型 | 要打开的文件路径 |

**逻辑流程：**

\1. 检查文件是否存在

\2. 若存在，则读取内容并显示在 code 编辑框中

\3. 更新当前处理文件路径（全局变量 `当前处理文件`）

.如果真 (文件是否存在 (文件) ＝ 假)

​    返回 ()

.如果真结束

当前处理文件 ＝ 文件

code.置文本 (到文本 (读入文件 (文件)))

### ⌨️ `_code_处理新字符`

**功能：** 处理用户输入的新字符，触发自动完成提示。

|                |        |                |
| -------------- | ------ | -------------- |
| `接收到的字符` | 文本型 | 当前输入的字符 |

**逻辑流程：**

\1. 获取当前光标位置

\2. 计算所在列号

\3. 如果列号为 0（行首），可做特殊处理（目前为空）

\4. 显示自动完成列表（基于预加载的“Area”词库）

code.显示自动完成 (列号, 编码转换G_U (自动完成填充))

> 💡 使用 `编码转换G_U` 处理字符编码兼容性（适用于 UTF-8 环境）。 

## ⚙️ 配置与扩展

### 自动完成词库 (`Area` 文件)

- 路径：程序运行目录下的 `\Area`

- 内容格式：纯文本，每行一个关键词

  

> 此文件将被读取为 `自动完成填充` 变量，用于提示补全。 

## 🎨 界面代理功能

通过 `界面代理` 对象实现高级 UI 控制：

|                               |                                  |
| ----------------------------- | -------------------------------- |
| `界面代理.初始化(code, 画版)` | 绑定编辑器与绘图控件             |
| `界面代理.画横向刻度()`       | 绘制水平标尺（用于对齐参考）     |
| `界面代理.初始化默认风格()`   | 设置默认代码风格（颜色、字体等） |
| `界面代理.初始化自动提示()`   | 启用自动提示功能                 |

## 📌 待优化建议（未来方向）

1. ✅ **文件保存功能缺失**：当前仅支持加载，未见保存逻辑。
2. ✅ **错误处理不足**：缺少异常捕获与用户提示。
3. ✅ **Message 面板未激活**：可用于显示编译信息或日志。
4. ✅ **多标签页支持**：当前仅支持单文件编辑。
5. ✅ **主题切换功能**：可扩展深色/浅色模式。